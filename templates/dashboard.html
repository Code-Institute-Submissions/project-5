{% extends "base.html" %}

{% block main_content %}
<section class="container vh100">
	<div class="row">
		<div class="card-deck col-12">
			<div class="card">
				<div class="card-header">Users</div>
				<div class="card-body">
					{% for user in users %}
					<div class="card">
						<div class="card-header"> {{user.username}}</div>
						<div class="card-body">
							<ul>
								<li>email: {{user.email}}</li>
								<li>password: {{user.password}}</li>
							</ul>
						</div>
					</div>
					{% endfor %}
				</div>
			</div>
			<div class="card">
				<div class="card-header">Database</div>
				<div class="card-body">
					{% for setting in forms %}
					<div class="card">
						<div class="card-header"> {{setting._id}}</div>
						<div class="card-body">
							{{setting}}
						</div>
					</div>
					{% endfor %}
				</div>
				<div class="card-footer">
					<button id="update-db" class="btn btn-danger " disabled>Update DB</button>
				</div>
			</div>
		</div>
</section>
{% endblock main_content %}

{% block scripts %}
<script>
	$(document).ready(function () {
		$("#update-db").removeAttr("disabled")

		$("#update-db").on("click", function () {
			$("#update-db").attr("disabled", true).html("Updating");
			$.post(`/update-db`, function (data, status) {
				console.log(status);
				if (status == "success") {

					window.location.replace("/admin_dashboard");
				}

			}).fail(function (xhr, status, error) {
				console.log(xhr);
				console.log(status);
				console.log(error);
			});

		});

	});
</script>
{% endblock scripts %}